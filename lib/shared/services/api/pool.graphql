query GetPool($id: String!, $chain: GqlChain!, $userAddress: String) {
  pool: poolGetPool(id: $id, chain: $chain, userAddress: $userAddress) {
    id
    address
    name
    version
    owner
    decimals
    factory
    symbol
    createTime
    type
    chain
    vaultVersion
    dynamicData {
      poolId
      swapEnabled
      totalLiquidity
      totalShares
      fees24h
      swapFee
      volume24h
      holdersCount
      isInRecoveryMode
      isPaused
      apr {
        hasRewardApr
        thirdPartyApr {
          ... on GqlPoolAprTotal {
            total
          }
          ... on GqlPoolAprRange {
            min
            max
          }
        }
        nativeRewardApr {
          ... on GqlPoolAprTotal {
            total
          }
          ... on GqlPoolAprRange {
            min
            max
          }
        }
        swapApr
        apr {
          ... on GqlPoolAprTotal {
            total
          }
          ... on GqlPoolAprRange {
            min
            max
          }
        }
        items {
          id
          title
          apr {
            ... on GqlPoolAprTotal {
              total
            }
            ... on GqlPoolAprRange {
              min
              max
            }
          }
          subItems {
            id
            title
            apr {
              ... on GqlPoolAprTotal {
                total
              }
              ... on GqlPoolAprRange {
                min
                max
              }
            }
          }
        }
      }
    }
    allTokens {
      id
      address
      name
      symbol
      decimals
      isNested
      isPhantomBpt
      isMainToken
    }
    displayTokens {
      id
      address
      name
      weight
      symbol
      nestedTokens {
        id
        address
        name
        weight
        symbol
      }
    }
    staking {
      id
      type
      chain
      address
      gauge {
        id
        gaugeAddress
        version
        status
        workingSupply
        otherGauges {
          gaugeAddress
          version
          status
          id
          rewards {
            id
            tokenAddress
            rewardPerSecond
          }
        }
        rewards {
          id
          rewardPerSecond
          tokenAddress
        }
      }
    }
    userBalance {
      stakedBalance
      totalBalance
      walletBalance
      stakedBalanceUsd
      walletBalanceUsd
      totalBalanceUsd
    }
    ... on GqlPoolWeighted {
      nestingType
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolStable {
      amp
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolMetaStable {
      amp
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolElement {
      unitSeconds
      principalToken
      baseToken
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolComposableStable {
      amp
      nestingType
      bptPriceRate
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolLinear {
      mainIndex
      wrappedIndex
      lowerTarget
      upperTarget
      bptPriceRate
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolLiquidityBootstrapping {
      name
      nestingType
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolGyro {
      alpha
      beta
      type
      c
      dSq
      lambda
      root3Alpha
      s
      sqrtAlpha
      sqrtBeta
      tauAlphaX
      tauAlphaY
      tauBetaX
      tauBetaY
      u
      v
      w
      z
      nestingType
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
    ... on GqlPoolFx {
      alpha
      beta
      delta
      epsilon
      lambda
      poolTokens {
        ... on GqlPoolTokenDetail {
          id
          index
          name
          symbol
          balance
          address
          priceRate
          decimals
          weight
          hasNestedPool
          nestedPool {
            id
            address
            type
            tokens {
              index
              address
              decimals
            }
          }
        }
      }
    }
  }
}

query GetPoolSnapshots($poolId: String!, $range: GqlPoolSnapshotDataRange!, $chainId: GqlChain!) {
  snapshots: poolGetSnapshots(id: $poolId, range: $range, chain: $chainId) {
    id
    timestamp
    totalLiquidity
    volume24h
    fees24h
    sharePrice
  }
}

query GetPoolTokensDynamicData($addresses: [String!]!) {
  staticData: tokenGetTokensData(addresses: $addresses) {
    id
    tokenAddress
    description
    discordUrl
    telegramUrl
    twitterUsername
    websiteUrl
  }
  dynamicData: tokenGetTokensDynamicData(addresses: $addresses) {
    ...GqlTokenDynamicData
  }
}

query GetPoolEvents($first: Int, $poolId: String!, $chain: GqlChain!) {
  poolEvents(
    first: $first
    where: {
      poolId: $poolId
      chain: $chain
    }
  ) {
    id
    poolId
    timestamp
    tx
    type
    valueUSD
    userAddress
    ... on GqlPoolSwapEventV3 {
      tokenIn {
        address
        amount
      }
      tokenOut {
        address
        amount
      }
    }
    ... on GqlPoolJoinExitEventV3 {
      tokens {
        address
        amount
        valueUSD
      }
    }
  }
}
